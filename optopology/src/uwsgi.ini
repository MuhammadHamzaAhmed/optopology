[uwsgi]
# Basic configuration
http = :5017
wsgi-file = app.py
callable = app
single-interpreter = true
master = true

# Process management
processes = 2
threads = 4
enable-threads = true

# Logging
req-logger = file:/usr/src/applogs/reqlog
logger = file:/usr/src/applogs/errlog

# Auto-reload for development (disable in production)
py-autoreload = 1

# ===========================================
# SPOOLER - Async Background Tasks
# ===========================================
# Directory where background tasks are queued
spooler = /usr/src/app/spooler
# Number of spooler processes
spooler-processes = 2
# Import the spooler tasks module
spooler-import = tasks
# Spooler frequency check (seconds)
spooler-frequency = 10
# Max number of tasks to run at once per spooler
spooler-max-tasks = 10

# ===========================================
# CRON - Scheduled Tasks
# ===========================================
# Format: cron = <minute> <hour> <day> <month> <weekday> <command>
# Use -1 for "every" (wildcard)

# Example: Run every minute
# cron = -1 -1 -1 -1 -1 /usr/src/app/cron_tasks.py

# Example: Run every hour at minute 0
# cron = 0 -1 -1 -1 -1 /usr/src/app/cron_tasks.py

# Example: Run daily at midnight
# cron = 0 0 -1 -1 -1 /usr/src/app/cron_tasks.py

# ===========================================
# MULE - Alternative Background Workers
# ===========================================
# Mules are independent worker processes
# mule = mule_worker.py
# mules = 2

# ===========================================
# Performance & Reliability
# ===========================================
# Reload workers after this many requests (prevents memory leaks)
max-requests = 5000
# Reload worker if it takes longer than 60s
harakiri = 60
# Restart workers gracefully
reload-mercy = 10
# Vacuum (clean up) on exit
vacuum = true
# Die on term signal
die-on-term = true
